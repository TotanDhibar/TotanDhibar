<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %> - <%= contactInfo ? contactInfo.company_name : 'UCC Engineering' %></title>
    <meta name="description" content="Contact UCC Engineering Contractors for power plant maintenance and engineering services">
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <%- include('../partials/header', { contactInfo }) %>
    
    <main>
        <section class="page-header">
            <div class="container">
                <h1><%= title %></h1>
                <p>Get in touch with us</p>
            </div>
        </section>

        <section class="contact-section">
            <div class="container">
                <div class="contact-wrapper">
                    <div class="contact-form-container animate-fade-in">
                        <h2>Send us a Message</h2>
                        
                        <% if (success && success == '1') { %>
                        <div class="alert alert-success">
                            Thank you for your message! We will get back to you soon.
                        </div>
                        <% } %>
                        
                        <% if (errors && errors.length > 0) { %>
                        <div class="alert alert-error">
                            <ul>
                                <% errors.forEach(function(error) { %>
                                <li><%= error.msg %></li>
                                <% }); %>
                            </ul>
                        </div>
                        <% } %>
                        
                        <form method="POST" action="/contact" class="contact-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="name">Name *</label>
                                    <input type="text" id="name" name="name" required placeholder="Your Name">
                                </div>
                                
                                <div class="form-group">
                                    <label for="email">Email *</label>
                                    <input type="email" id="email" name="email" required placeholder="your@email.com">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="phone">Phone</label>
                                    <input type="tel" id="phone" name="phone" placeholder="+91-XXXXXXXXXX">
                                </div>
                                
                                <div class="form-group">
                                    <label for="subject">Subject *</label>
                                    <input type="text" id="subject" name="subject" required placeholder="How can we help?">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="message">Message *</label>
                                <textarea id="message" name="message" rows="5" required placeholder="Your message here..."></textarea>
                            </div>
                            
                            <button type="submit" class="btn btn-primary btn-block">Send Message</button>
                        </form>
                    </div>
                    
                    <% if (contactInfo) { %>
                    <div class="contact-info-container animate-slide-up">
                        <h2>Contact Information</h2>
                        <div class="contact-details">
                            <div class="contact-item">
                                <span class="contact-icon">üè¢</span>
                                <div>
                                    <h4>Company</h4>
                                    <p><%= contactInfo.company_name %></p>
                                </div>
                            </div>
                            <% if (contactInfo.address) { %>
                            <div class="contact-item">
                                <span class="contact-icon">üìç</span>
                                <div>
                                    <h4>Address</h4>
                                    <p><%= contactInfo.address %></p>
                                    <% if (contactInfo.location) { %>
                                    <p><%= contactInfo.location %></p>
                                    <% } %>
                                </div>
                            </div>
                            <% } %>
                            <% if (contactInfo.phone) { %>
                            <div class="contact-item">
                                <span class="contact-icon">üìû</span>
                                <div>
                                    <h4>Phone</h4>
                                    <p><a href="tel:<%= contactInfo.phone %>"><%= contactInfo.phone %></a></p>
                                </div>
                            </div>
                            <% } %>
                            <% if (contactInfo.email) { %>
                            <div class="contact-item">
                                <span class="contact-icon">üìß</span>
                                <div>
                                    <h4>Email</h4>
                                    <p><a href="mailto:<%= contactInfo.email %>"><%= contactInfo.email %></a></p>
                                </div>
                            </div>
                            <% } %>
                            <% if (contactInfo.gst_number) { %>
                            <div class="contact-item">
                                <span class="contact-icon">üìã</span>
                                <div>
                                    <h4>GST Number</h4>
                                    <p><%= contactInfo.gst_number %></p>
                                </div>
                            </div>
                            <% } %>
                        </div>
                        
                        <!-- Google Maps Embed -->
                        <% if (contactInfo.google_map_embed) { %>
                        <div class="map-container">
                            <h3>Find Us</h3>
                            <div class="map-wrapper">
                                <%- contactInfo.google_map_embed %>
                            </div>
                        </div>
                        <% } else if (contactInfo.gps_latitude && contactInfo.gps_longitude) { %>
                        <!-- GPS Location Map -->
                        <div class="map-container">
                            <h3>üìç Our Location</h3>
                            <div class="gps-location-wrapper">
                                <div id="company-map" class="company-map"></div>
                                <div class="gps-actions">
                                    <a href="https://www.google.com/maps?q=<%= contactInfo.gps_latitude %>,<%= contactInfo.gps_longitude %>" 
                                       target="_blank" 
                                       rel="noopener noreferrer" 
                                       class="btn btn-primary btn-small">
                                        üó∫Ô∏è Open in Google Maps
                                    </a>
                                    <a href="https://www.google.com/maps/dir/?api=1&destination=<%= contactInfo.gps_latitude %>,<%= contactInfo.gps_longitude %>" 
                                       target="_blank" 
                                       rel="noopener noreferrer" 
                                       class="btn btn-secondary btn-small">
                                        üöó Get Directions
                                    </a>
                                </div>
                                <p class="gps-coordinates">
                                    <small>GPS: <%= contactInfo.gps_latitude.toFixed(6) %>, <%= contactInfo.gps_longitude.toFixed(6) %></small>
                                </p>
                            </div>
                        </div>
                        <% } %>
                    </div>
                    <% } %>
                </div>
            </div>
        </section>
    </main>
    
    <%- include('../partials/footer', { contactInfo }) %>
    
    <script src="/js/main.js"></script>
    <% if (contactInfo && contactInfo.gps_latitude && contactInfo.gps_longitude && !contactInfo.google_map_embed) { %>
    <!-- Leaflet CSS and JS for OpenStreetMap (free, no API key required) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="">
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var lat = <%= contactInfo.gps_latitude %>;
            var lng = <%= contactInfo.gps_longitude %>;
            var companyName = <%= JSON.stringify(contactInfo.company_name) %>;
            var address = <%= JSON.stringify(contactInfo.address || "") %>;
            
            var map = L.map('company-map').setView([lat, lng], 15);
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                maxZoom: 19,
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);
            
            var marker = L.marker([lat, lng]).addTo(map);
            marker.bindPopup('<strong>' + companyName + '</strong><br>' + address).openPopup();
        });
    </script>
    <% } %>
</body>
</html>
