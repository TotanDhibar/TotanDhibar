<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %> - <%= contactInfo ? contactInfo.company_name : 'UCC Engineering' %></title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <%- include('../partials/header', { contactInfo }) %>
    
    <main>
        <section class="page-header">
            <div class="container">
                <h1><%= title %></h1>
                <p>Our certifications and downloadable resources</p>
            </div>
        </section>

        <% if (certificates && certificates.length > 0) { %>
        <section class="certificates-section" style="padding: 60px 0;">
            <div class="container">
                <h2 class="section-title">Our Certificates</h2>
                <div class="certificates-list">
                    <% certificates.forEach(function(cert, index) { %>
                    <div class="certificate-card animate-fade-in" style="animation-delay: <%= index * 0.1 %>s; margin-bottom: 30px;">
                        <% 
                        var fileExt = cert.file_path ? cert.file_path.toLowerCase().split('.').pop() : '';
                        var isPdf = fileExt === 'pdf';
                        var imageExtensions = ['jpg', 'jpeg', 'png', 'gif'];
                        var isImage = imageExtensions.includes(fileExt);
                        %>
                        <div class="certificate-icon">üìÑ</div>
                        <h3><%= cert.title %></h3>
                        <% if (cert.description) { %>
                        <p><%= cert.description %></p>
                        <% } %>
                        <% if (isPdf) { %>
                        <div class="certificate-viewer" style="margin: 20px 0; border: 1px solid #ddd; border-radius: 8px; overflow: hidden;">
                            <iframe src="<%= cert.file_path %>" style="width: 100%; height: 600px; border: none;" title="<%= cert.title %>"></iframe>
                        </div>
                        <% } else if (isImage) { %>
                        <div class="certificate-viewer" style="margin: 20px 0; border: 1px solid #ddd; border-radius: 8px; overflow: hidden;">
                            <img src="<%= cert.file_path %>" alt="<%= cert.title %>" style="width: 100%; height: auto; display: block;" />
                        </div>
                        <% } %>
                        <a href="<%= cert.file_path %>" class="btn btn-primary btn-small" target="_blank" download>Download</a>
                        <p class="upload-date">Uploaded: <%= new Date(cert.upload_date).toLocaleDateString() %></p>
                    </div>
                    <% }); %>
                </div>
            </div>
        </section>
        <% } %>

        <% if (downloads && downloads.length > 0) { %>
        <section class="downloads-section" style="padding: 60px 0; background: #f8f9fa;">
            <div class="container">
                <h2 class="section-title">Downloads</h2>
                <div class="downloads-list">
                    <% downloads.forEach(function(download, index) { %>
                    <div class="download-card animate-fade-in" style="animation-delay: <%= index * 0.1 %>s">
                        <div class="download-icon">üìÅ</div>
                        <h3><%= download.title %></h3>
                        <% if (download.category) { %>
                        <span class="category-badge"><%= download.category %></span>
                        <% } %>
                        <% if (download.description) { %>
                        <p><%= download.description %></p>
                        <% } %>
                        <a href="<%= download.file_path %>" class="btn btn-primary btn-small" target="_blank" download>Download</a>
                    </div>
                    <% }); %>
                </div>
            </div>
        </section>
        <% } %>

        <% if ((!certificates || certificates.length === 0) && (!downloads || downloads.length === 0)) { %>
        <section style="padding: 80px 0; text-align: center;">
            <div class="container">
                <p>No certificates or downloads available at this time. Please check back later.</p>
            </div>
        </section>
        <% } %>
    </main>
    
    <%- include('../partials/footer', { contactInfo }) %>
    
    <script src="/js/main.js"></script>
</body>
</html>
