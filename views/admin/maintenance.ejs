<%- include('layout', {
    title: 'Maintenance Schedule',
    body: `
    <!-- Maintenance Schedule Page -->
    <div class="row">
        <div class="col-12">
            <div class="card hover-lift">
                <div class="card-header bg-gradient-success text-white">
                    <h3 class="card-title mb-0"><i class="fas fa-calendar-alt mr-2"></i> Maintenance Schedule</h3>
                    <div class="card-tools">
                        <button class="btn btn-light btn-sm" data-toggle="modal" data-target="#addScheduleModal">
                            <i class="fas fa-plus"></i> Schedule Maintenance
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <!-- Calendar View Toggle -->
                    <div class="btn-group mb-3" role="group">
                        <button type="button" class="btn btn-outline-primary active" data-view="list">
                            <i class="fas fa-list"></i> List View
                        </button>
                        <button type="button" class="btn btn-outline-primary" data-view="calendar">
                            <i class="fas fa-calendar"></i> Calendar View
                        </button>
                    </div>

                    <!-- List View -->
                    <div class="table-responsive">
                        <table class="table admin-table">
                            <thead>
                                <tr>
                                    <th>Client</th>
                                    <th>Service Type</th>
                                    <th>Scheduled Date</th>
                                    <th>Team</th>
                                    <th>Duration</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
` + (schedules && schedules.length > 0 ? schedules.map(schedule => `
                                <tr>
                                    <td><strong>${schedule.client_name || 'N/A'}</strong></td>
                                    <td>${schedule.service_type}</td>
                                    <td>${new Date(schedule.scheduled_date).toLocaleDateString()}</td>
                                    <td>${schedule.assigned_team || 'Unassigned'}</td>
                                    <td>${schedule.estimated_duration || 'TBD'}</td>
                                    <td>
                                        <span class="badge ${
                                            schedule.status === 'Completed' ? 'badge-status-completed' :
                                            schedule.status === 'In Progress' ? 'badge-status-pending' :
                                            'badge-status-active'
                                        }">${schedule.status}</span>
                                    </td>
                                    <td>
                                        <div class="btn-group btn-group-sm">
                                            <button class="btn btn-info" title="View Details">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                            <button class="btn btn-primary" title="Edit">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="btn btn-danger" title="Delete">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
`).join('') : '<tr><td colspan="7" class="text-center text-muted">No scheduled maintenance</td></tr>') + `
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Status Summary Cards -->
    <div class="row mt-4">
        <div class="col-lg-3 col-md-6">
            <div class="stat-card">
                <div class="stat-icon"><i class="fas fa-calendar-check"></i></div>
                <h3>${scheduleStats.total || 0}</h3>
                <p>Total Scheduled</p>
            </div>
        </div>
        <div class="col-lg-3 col-md-6">
            <div class="stat-card success">
                <div class="stat-icon"><i class="fas fa-clock"></i></div>
                <h3>${scheduleStats.scheduled || 0}</h3>
                <p>Upcoming</p>
            </div>
        </div>
        <div class="col-lg-3 col-md-6">
            <div class="stat-card highlight">
                <div class="stat-icon"><i class="fas fa-spinner"></i></div>
                <h3>${scheduleStats.inProgress || 0}</h3>
                <p>In Progress</p>
            </div>
        </div>
        <div class="col-lg-3 col-md-6">
            <div class="stat-card info">
                <div class="stat-icon"><i class="fas fa-check-double"></i></div>
                <h3>${scheduleStats.completed || 0}</h3>
                <p>Completed</p>
            </div>
        </div>
    </div>

    <!-- Upcoming Maintenance Timeline -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="card hover-lift">
                <div class="card-header bg-gradient-warning text-white">
                    <h3 class="card-title mb-0"><i class="fas fa-clock mr-2"></i> Upcoming Maintenance</h3>
                </div>
                <div class="card-body">
                    <div class="timeline">
` + (upcomingSchedules && upcomingSchedules.length > 0 ? upcomingSchedules.slice(0, 5).map(schedule => `
                        <div class="timeline-item">
                            <div class="timeline-content">
                                <h4 style="font-size: 1rem; font-weight: 600; margin-bottom: 0.5rem;">
                                    ${schedule.service_type} - ${schedule.client_name}
                                </h4>
                                <p style="margin: 0; color: #64748b; font-size: 0.875rem;">
                                    Team: ${schedule.assigned_team || 'TBD'} | Duration: ${schedule.estimated_duration || 'TBD'}
                                </p>
                                <small style="color: #94a3b8;">
                                    ${new Date(schedule.scheduled_date).toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}
                                </small>
                            </div>
                        </div>
`).join('') : '<p class="text-muted">No upcoming maintenance scheduled</p>') + `
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Schedule Modal -->
    <div class="modal fade" id="addScheduleModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title"><i class="fas fa-calendar-plus"></i> Schedule Maintenance</h5>
                    <button type="button" class="close text-white" data-dismiss="modal">&times;</button>
                </div>
                <form method="POST" action="/admin/maintenance/add">
                    <div class="modal-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Client *</label>
                                    <select name="client_id" class="form-control" required>
                                        <option value="">Select Client</option>
` + (clients && clients.length > 0 ? clients.map(client => `
                                        <option value="${client.id}">${client.name}</option>
`).join('') : '') + `
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Service Type *</label>
                                    <select name="service_type" class="form-control" required>
                                        <option value="">Select Service</option>
                                        <option value="AMC">AMC</option>
                                        <option value="Boiler Maintenance">Boiler Maintenance</option>
                                        <option value="ESP Maintenance">ESP Maintenance</option>
                                        <option value="APH Maintenance">APH Maintenance</option>
                                        <option value="Overhauling">Overhauling</option>
                                        <option value="Shutdown Services">Shutdown Services</option>
                                        <option value="Emergency Repair">Emergency Repair</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Scheduled Date *</label>
                                    <input type="date" name="scheduled_date" class="form-control" required>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Estimated Duration</label>
                                    <input type="text" name="estimated_duration" class="form-control" placeholder="e.g., 8 hours, 2 days">
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Assign Team</label>
                                    <select name="assigned_team" class="form-control">
                                        <option value="">Select Team</option>
                                        <option value="Team A">Team A</option>
                                        <option value="Team B">Team B</option>
                                        <option value="Team C">Team C</option>
                                        <option value="Team D">Team D</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label>Status</label>
                                    <select name="status" class="form-control">
                                        <option value="Scheduled">Scheduled</option>
                                        <option value="In Progress">In Progress</option>
                                        <option value="Completed">Completed</option>
                                        <option value="Cancelled">Cancelled</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Notes</label>
                            <textarea name="notes" class="form-control" rows="3" placeholder="Add any special instructions or requirements..."></textarea>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-success">Schedule Maintenance</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    `
}) %>
